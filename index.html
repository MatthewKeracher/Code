
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="stylesheet" href="css-folder/styles.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:ital@1&display=swap" rel="stylesheet">


    <title>Excel_DM</title>
    <style>
  
    
    </style>     


<br>

  </head>

  <div id = 'header'>

   
    <label for="chkEditor">
      Show Editor?
    </label>

    <form id = "mapData" onsubmit = "google.script.run.processData(this.form);" 
  
    action = "https://script.google.com/macros/s/AKfycbyZeetQLyvCPUav_vm2Xi-I64YrOotBWgAHycyfc3ICw7RpXW1-aQ34eSVOwYKL8t9O/exec" style = "z-index: 5" >    

   
    </form>
   


  </div>

  <body id = 'body' >

    <div id = "popUp" style = "display:none;"> 
   
      <div id = "popUpBackground">

        <div id = "Locations" class="InventoryClass" ></div>
     
        <div id = "Containers" class="InventoryClass" ></div>

        <div id = "Contents" class="InventoryClass" > </div>

        <div id = "itemDisplay">

          <p id = "itemType" style = "color: orange ; margin: 1px;"></p>

          <hr id = "hr1"  size="3" width="100%" float="left" color="DarkOrange">  

          <p id = "itemName" style = "font-size: 30px;  margin: 1px; "></p> 

          <hr id = "hr2"   size="3" width="100%" float="left" color="DarkOrange">  
          
          <p id = "itemWeight"  style = "color: orange"></p>
          
          <p id = "itemPortions"  style = "color: orange"></p>
          
          <p id = "itemTotalWeight"  style = "color: orange"></p>

          <hr id = "hr3"   size="3" width="100%" float="left" color="DarkOrange">  

          <div id = "itemDescs"> 
          
          <p id = "itemDesc1"></p>

          <p id = "itemDesc2"></p>

          <p id = "itemDesc3"></p>

        </div>
      </div>


        <div id = "EdititemDisplay" style = "display: none;">

              
              Name: 
              <br> <br>
              <textarea id = "EdititemName" name = "itemName"  form = "mapData" style = "height: 20px; width:  450px; background-color: rgb(0, 0, 0); color: orange" ></textarea> </textarea> <br><br>

              Type: 
              <br> <br>
              <textarea id = "EdititemType"  name = "itemType"  form = "mapData" style = "height: 20px; width:  450px; background-color: rgb(0, 0, 0); color: orange" > </textarea> <br><br>

              Weight, each. Lbs. 
              <br> <br>
              <textarea id = "EdititemWeight"   name = "itemWeight" form = "mapData" style = "height: 20px; width:  50px; background-color: rgb(0, 0, 0); color: orange" > </textarea><br><br>

              # Portions. 
              <br> <br>
              <textarea id = "EdititemPortions" name = "itemPortions"  form = "mapData" style = "height: 20px; width:  50px; background-color: rgb(0, 0, 0); color: orange" > </textarea>   <br> <br>

              Physically Attributes:
              <br> <br>            
              <textarea id = "EdititemDesc1" name = "itemDesc1"  form = "mapData" style = "height: 120px; width:  450px; background-color: rgb(0, 0, 0); color: orange" > </textarea>   <br> <br>

              Mechanically Attributes:
              <br> <br>             
              <textarea id = "EdititemDesc2" name = "itemDesc2"  form = "mapData" style = "height: 120px; width:  450px; background-color: rgb(0, 0, 0); color: orange" > </textarea>   <br> <br>
              
              Historical or Social Attributes:
              <br> <br>            
              <textarea id = "EdititemDesc3" name = "itemDesc3"  form = "mapData" style = "height: 120px; width: 450px; background-color: rgb(0, 0, 0); color: orange" > </textarea>   <br> <br>

              <select id="setContainer" name = "container"  form = "mapData" style="background-color: rgb(0, 0, 0); color: violet">
                                         
              </select> 
              
              <input id="saveItem" type="button" value="Save" /> 

        </div>
      

      <div id = "popUpButtons"> 

       <br><br>

      <input id="hideInventory" type="button" value="X" style = "float: right"/>  <br><br>
  

      </div>


      <div id = "AbilityScores" >
        <br> <br>

       <select id="Player" style=" width: 400px; background-color: rgb(0, 0, 0); color: orange; font-family: 'Courier Prime', monospace;  font-size: 20px;">
                         
        </select>

        <div id = "AbilityScoreButtons" style = "opacity: 0.5">

          <input id="loadCharacter" type="button" value="Show Inventory" /> <input id="editItem" type="button" value="Edit Current Item" /> <input id="newItem" type="button" value="Define New Item" /> 
          </div>
     
        <hr id = "hr4"  size="3" width="100%" float="left" color="Ivory">  
     
        <p id = "Strength"></p>
        
        <p id = "Dexterity"></p>
        
        <p id = "Intelligence"></p>
        
        <p id = "Wisdom"></p>
        
        <p id = "Constitution"></p>
        
        <p id = "Charisma"></p>
        
        <p id = "Psyche"></p>
       
        <p id = "Luck"></p>

        
        <br>

        <hr id = "hr5"  size="3" width="100%"  float="left" color="Ivory">  
        

        <p id = "Combat"></p> 

       
      </div>
   </div> 
  
    </div> 
   
    <div id='wrapper'> 

      <div id = "grids" >
        
        <canvas
        class = "center"
        id="gridImg"
        width= "3800"      
        height="1600"></canvas>
       
        <canvas
        class = "center"
        id="gridBtm"
        width= "3800"      
        height="1600"></canvas>
        

        <canvas
        class = "center"
        id="gridMid"
        width="3800"
        height="1600"
        ></canvas>

        <canvas
        class = "center"
        id="gridTop"
        width="3800"
        height="1600"
        ></canvas>

       

    
  </div>

    </div>
    
    <div id="sidebarwrapper">

      <div id="sidebar">

        <div id="sidebaritem" class="mousescroll">

          <img id = 'logo'  src="images/BannerLogo.gif" alt="EXCEL_DM_LOGO" >  <br><br>

          Author:
          <input id= "user" name = "user" form = "mapData" type="text" > 

          <select id="Usertype" style="float: right; background-color: rgb(0, 0, 0); color: orange">
              
            <option value = 0 > Player </option> 
            <option value = 1 > Dungeon Master </option>
                     
          </select> <br><br>



          <select id="Activity" style=" display: none; float: right; background-color: rgb(0, 0, 0); color: violet">
              
            <option value = 0 > Reading </option> 
            <option value = 1 > Writing </option>
            <option value = 2 > Painting </option>
            <option value = 3 > Playing </option>
            <option value = 4 > mapForm </option>
                        
          </select>
 
          <div id = "mapForm">  

            <br><br><br><br><br>

            username     <input name= "username"     form = "mapData"   id= "mapData_user"        type="text"    > <br><br>
            sheetName    <input name= "sheetName"    form = "mapData"   id= "mapData_sheetName"   type="text"    > <br><br>
            parentID     <input name= "parentID"     form = "mapData"   id= "mapData_parentID"    type="text"    > <br><br>
            uniqueID     <input name= "uniqueID"     form = "mapData"   id= "mapData_uniqueID"    type="text"    > <br><br>
            X            <input name= "X"            form = "mapData"   id= "mapData_X"           type="text"    > <br><br>
            Y            <input name= "Y"            form = "mapData"   id= "mapData_Y"           type="text"    > <br><br>
            Z            <input name= "Z"            form = "mapData"   id= "mapData_Z"           type="text"    > <br><br>
            fill         <input name= "fill"         form = "mapData"   id= "mapData_fill"        type="text"    > <br><br>
            Activity     <input name= "Activity"     form = "mapData"   id= "mapData_Activity"    type="text"    > <br><br>
            isWeather    <input name= "isWeather"    form = "mapData"   id= "mapData_isWeather"   type="text"    > <br><br>
            isNPC        <input name= "isNPC"        form = "mapData"   id= "mapData_isNPC"       type="text"    > <br><br>
            isEffect     <input name= "isEffect"     form = "mapData"   id= "mapData_isEffect"    type="text"    > <br><br>
            isInventory  <input name= "isInventory"  form = "mapData"   id= "mapData_isInventory" type="text"    > <br><br>
            playerID     <input name= "playerID"     form = "mapData"   id= "mapData_playerID"    type="text"    > <br><br>
            uniqueinvid  <input name= "uniqueinvid"  form = "mapData"   id= "mapData_uniqueinvid" type="text"    > <br><br>
            isNewItem    <input name= "isNewItem"    form = "mapData"   id= "mapData_isNewItem"   type="text"    > <br><br>
      
        </div>

          <div id = "Playing"> 
  
            
           
            <input id="showInventory" type="button" value="Show Character Interface"/>   
               

          </div>
        
          <div id = "Painting">
           
            Focus:

           <select id="zLayer" name="Z" style="background-color: rgb(0, 0, 0); color: orange"> 
            
                <option value = 1 > Locations </option>
                <option value = 0 > Gaia </option>
                <option value = 2 > Level 1 </option>
           
        </select>  <br> <br>

            URL:  <input id= "backgroundImage"  type="text" style="width: 75%; background-color: rgb(0, 0, 0); color: violet" >  <br> <br> 

            <input id="enlargeImage" type="button" value="Enlarge"  /> <input id="reduceImage" type="button" value="Reduce"  /> 
            
            <input id="imageLeft" type="button" value="Move Left"  /> 
            <input id="imageRight" type="button" value="Move Right"  /> 
            
            <input id="imageUp" type="button" value="Move Up"  /> 
            <input id="imageDown" type="button" value="Move Down"  /> 

            <br> <br> 

            <input id="rotateLeft" type="button" value="Rotate Left"  /> 
            <input id="rotateRight" type="button" value="Rotate Right"  /> 


            <br><br>

          <input id="paintButton" type="button" value="Save All"  />
          <input id="clearButton" type="button" value="Discard All"  /> 
          <input id="undoButton" type="button" value="Undo"  /> <br> <br>

          Background Colour:
                              
            <select id="backFill" name="backFill" style="width: 150px; background-color: rgb(0, 0, 0); color: orange">

              <option value="black">black</option>
              <option value="green">green</option>
              <option value="darkgreen">dark green</option>
              <option value="teal">teal</option>
              <option value="cyan">cyan</option>
              <option value="darkcyan">dark cyan</option>
              <option value="skyblue">skyblue</option>
              <option value="blue">blue</option>
              <option value="midnightblue">midnight blue</option>
              <option value="gray">gray</option>
              <option value="darkgray">dark gray</option>
          
              <option value="red">red</option>
              <option value="darkred">dark red</option>
              <option value="orange">orange</option>
              <option value="darkorange">dark orange</option>
              <option value="gold">gold</option>
              <option value="wheat">wheat</option>
              <option value="white">white</option>
              <option value="whitesmoke">whitesmoke</option>
              
              <option value="indigo">indigo</option>
              <option value="violet">violet</option>
              <option value="purple">purple</option>
             
              <option value="brown">brown</option>
              <option value="peru">peru brown</option>
          
              <option value="delete">delete</option>
              
              
            </select> 

            <br><br>

            Grid Colour:

            <select id="gridColour" name="gridColour" style="width: 150px; background-color: rgb(0, 0, 0); color: orange">

              
              <option value="green">green</option>
              <option value="black">black</option>
              <option value="darkgreen">dark green</option>
              <option value="teal">teal</option>
              <option value="cyan">cyan</option>
              <option value="darkcyan">dark cyan</option>
              <option value="skyblue">skyblue</option>
              <option value="blue">blue</option>
              <option value="midnightblue">midnight blue</option>
              <option value="gray">gray</option>
              <option value="darkgray">dark gray</option>
          
              <option value="red">red</option>
              <option value="darkred">dark red</option>
              <option value="orange">orange</option>
              <option value="darkorange">dark orange</option>
              <option value="gold">gold</option>
              <option value="wheat">wheat</option>
              <option value="white">white</option>
              <option value="whitesmoke">whitesmoke</option>
              
              <option value="indigo">indigo</option>
              <option value="violet">violet</option>
              <option value="purple">purple</option>
             
              <option value="brown">brown</option>
              <option value="peru">peru brown</option>
          
              <option value="delete">delete</option>
              
              
            </select> 

          <p id = "paintArrayText"></p> <br>

          <canvas id="Palette"
            height="722"
            width = "361">
          </canvas>            
          
          </div>
   
          <div id = "Writing">

            <input id="run_permMap" type="button" value="Reload"/>  

            <div id = "EditorButtons">


            <br> <br> <button id="editLocation" style = "float: right ;" >  Edit Location </button><br>
            <br> <button id="EditWeather"  style = "float: right ;" >  Edit Weather  </button><br>
            <br> <button id="editEffects"  style = "float: right ;" >  Edit Effects  </button><br>
            <br> <button id="editNPCs"     style = "float: right ;" >  Edit NPCs     </button><br>

            </div>
      
            <div id = "Weather" style = "display: none"> 
              
              <button id="HideEditWeather" > Hide Weather Editor </button>

              <br> <br>

              Season:

              <select id="Season" name = "Season" form = "mapData" style="width: 90px; background-color: rgb(0, 0, 0); color: grey">  </select> 
           
  
              <select id="Time" name = "Day" form = "mapData" style="width: 90px; background-color: rgb(0, 0, 0); color: grey">   </select>      <br><br>  


              Select:
  
              <select id="weatherEntries" style="width: 190px; background-color: rgb(0, 0, 0); color: grey"> </select>    
              
              <br>
  

              <br><br>
              Weather Name:   
              <br> <br>
              <textarea id = "WeatherName" name = "Name" form = "mapData" style = "height: 25px; width: 100%; background-color: black; color: orange;"> </textarea> <br><br>
              Initial Description:   
              <br> <br>
              <textarea id = "WeatherDesc" name = "Description" form = "mapData" style = "height: 50px; width: 100%; background-color: black; color: orange;"> </textarea> <br><br>
              Threaded Description:
              <br> <br>
              <textarea id = "WeatherMod" name = "Modifier"     form = "mapData" style = "height: 50px; width: 100%; background-color: black; color: orange;"> </textarea> <br><br>
              NPC Weather Reaction:
              <br> <br>
              <textarea id = "WeatherReact" name = "Reaction"   form = "mapData" style = "height: 50px; width: 100%; background-color: black; color: orange;"> </textarea> 
              
               <br><br>

               <button id="SubmitWeather" >Save</button> <br> <br>
  
  
            </div>

            <div id = "Effects" style = "display: none">

               <button id="hideEditEffects" >Hide Effects Editor</button>

               <br> <br>

               
             

              Select:
  
              <select id="effectEntries" style="width: 190px; background-color: rgb(0, 0, 0); color: grey"> </select> 
  

              <br><br>
              Effect Name:   
              <br> <br>
              <textarea id = "effectName" name = "effectName"  form = "mapData" style = "height: 25px; width: 100%; background-color: black; color: orange;"> </textarea> <br><br>
              Initial Description:   
              <br> <br>
              <textarea id = "effectDesc"  name = "effectDesc"  form = "mapData" style = "height: 50px; width: 100%; background-color: black; color: orange;"> </textarea> <br><br>
              Threaded Description:
              <br> <br>
              <textarea id = "effectMod"   name = "effectMod"   form = "mapData" style = "height: 50px; width: 100%; background-color: black; color: orange;"> </textarea> <br><br>
              NPC Effect Reaction:
              <br> <br>
              <textarea id = "effectReact" name = "effectReact" form = "mapData" style = "height: 50px; width: 100%; background-color: black; color: orange;"> </textarea> 
              
               <br><br>

               <button id="submitEffect" >Save</button>
  
  
            </div>

            <div id = "NPCs" style = "display: none"> 

              <button id="hideEditNPCs" >Hide NPCs Editor</button>

             <br> <br>
    
              <p id = "npcTitleTwo" style = "color: cyan"></p>  
              <select id="npcEntries" style="width: 190px; background-color: rgb(0, 0, 0); color: grey"> </select>  <button id="loadNPCDescriptions" >Load</button> <br>
  
            

              <p id = "npcTitleThree" style = "color: cyan"></p>             
              <textarea id = "npcName" name = "npcName"  form = "mapData" style = "height: 25px; width: 100%; background-color: black; color: orange;"> </textarea> <br>
              
              <p id = "npcTitleFour" style = "color: cyan"></p>              
              <textarea id = "npc1"    name = "npc1"  form = "mapData" style = "height: 150px; width: 100%; background-color: black; color: orange;"> </textarea> <br>
              
              <p id = "npcTitleFive" style = "color: cyan"></p> 
              <textarea id = "npc2"    name = "npc2"   form = "mapData" style = "height: 150px; width: 100%; background-color: black; color: orange;"> </textarea> <br>
              
              <p id = "npcTitleSix" style = "color: cyan"></p> 
              <textarea id = "npc3"    name = "npc3" form = "mapData" style = "height: 150px; width: 100%; background-color: black; color: orange;"> </textarea> 
              
               <br><br>

               <button id="submitNPC" >Save</button>
  
  
            </div>
                   
            <div id = "LocationEditor" style = "display: none">

              <button id="hideLocationEditor" >Hide Location Editor</button>

              <br> <br> 

                Location Name:
                <input id= "Location" name = "Location" form = "mapData" type="text" autocomplete="off" style = "width: 100%;"> <br><br>
                Category:   
                <input id= "Category" name = "Category" form = "mapData" type="text" autocomplete="off" style = "width: 100%;"> <br> 
                
                <button id = "mapFormSubmit" type="submit" form = "mapData" style="float: left;"> Commit Changes </button>
                
                <br>

                

                <p id = "npcTitleOne" style = "color: cyan"></p> </p>
  
                <select id="oneNPC"   name = "oneNPC"    form = "mapData" style="width: 220px; background-color: rgb(0, 0, 0); color: grey">  </select> <br> <br>
             
                <select id="twoNPC"   name = "twoNPC"    form = "mapData" style="width: 220px; background-color: rgb(0, 0, 0); color: grey">   </select>  <br> <br>
                
                <select id="threeNPC" name = "threeNPC"  form = "mapData" style="width: 220px; background-color: rgb(0, 0, 0); color: grey">   </select>  <br> <br>  

                Saved Effects active in location: <br> <br>

              <select id="effectOne"  name = "effectOne" form = "mapData" style="width: 220px; background-color: rgb(0, 0, 0); color: grey">  </select> <br> <br>
           
              <select id="effectTwo"   name = "effectTwo" form = "mapData" style="width: 220px; background-color: rgb(0, 0, 0); color: grey">   </select>  <br> <br>
              
              <select id="effectThree" name = "effectThree" form = "mapData" style="width: 220px; background-color: rgb(0, 0, 0); color: grey">   </select>  <br> <br>
               
             
  
              <br> <br>
                
                Question 1:   
                <input id= "QA" name="QA" type="text"  form = "mapData"> <br> <br>
                <textarea id = "TextA" name = "Desc1" form = "mapData"></textarea> <br><br>
                Question 2:
                <input id= "QB" name="QB" type="text"  form = "mapData"> <br> <br>
                <textarea id = "TextB" name = "Desc2" form = "mapData"></textarea> <br><br>
                Question 3:
                <input id= "QC" name="QC" type="text"  form = "mapData"> <br> <br>
                <textarea id = "TextC" name = "Desc3" form = "mapData"></textarea> <br><br>
                Question 4:
                <input id= "QD" name="QD" type="text"  form = "mapData"> <br> <br>
                <textarea id = "TextD" name = "Desc4" form = "mapData"></textarea> <br><br>
                Question 5:
                <input id= "QE" name="QE" type="text"  form = "mapData"> <br> <br>
                <textarea id = "TextE" name = "Desc5" form = "mapData"></textarea> <br><br>

                      

                &nbsp;

                <input id= "sheetName"  type="text"  >
                <input id= "parentID"   type="text"  >
                <input id= "uniqueID"   type="text"  > 

            </div>

            </div>

          <div id = "Reading"> 

            <br>
          
            <button id="clearStory" >Clear Story</button>

            <p id = "storyTeller">  </p>  <button id="Expand" style = "display: none">Tell me more...</button>

            <br>

            <p style = "color: orange;" id = "Reading_QA"></p> <button id="AskQA" style = "display: none">Ask</button>
            
          

            <p style = "color: orange;" id = "Reading_QB"></p> <button id="AskQB" style = "display: none">Ask </button>



            <p style = "color: orange;" id = "Reading_QC"></p> <button id="AskQC" style = "display: none">Ask </button>



            <p style = "color: orange;" id = "Reading_QD"></p> <button id="AskQD" style = "display: none">Ask </button>



            <p style = "color: orange;" id = "Reading_QE"></p> <button id="AskQE" style = "display: none">Ask </button>
            

          </div>
          </div>

      </div> 
    </div> 
 
    <div class="output"></div>

    <script src="game.js" type="module"></script>

    
   
  </body>
</html>

